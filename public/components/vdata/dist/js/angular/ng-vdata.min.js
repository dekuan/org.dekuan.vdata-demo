angular.module("vdata",[]).constant("vdataConst",{ERROR:{SUCCESS:0,USER_START:10000,USER_END:99999,UNKNOWN:-100000,ACCESS_DENIED:-100001,PARAMETER:-100002,PERMISSION:-100003,EXPIRED:-100004,NOT_LOGGEDIN:-100005,FAILED_LOGGEDIN:-100006,CREATE_INSTANCE:-100010,EXCEPTION:-100011,DB_SELECT:-100050,DB_UPDATE:-100051,DB_INSERT:-100052,DB_DELETE:-100053,DB_DROP:-100054,DB_TRANSACTION:-100060,DB_TABLE_NAME:-100065,REQUEST_VIA_IP:-100100,NETWORK:-100300,JSON:-100301,JSON_ERRORID:-100302,JSON_ERRORDESC:-100303,JSON_VDATA:-100304},CONST:{HTTP_HEADER_VERSION_ACCEPT:"application/vdata+json+version:",HTTP_SUPPORTED_METHODS:{GET:true,POST:true,DELETE:true,PUT:true},DEFAULT_VERSION:"1.0",DEFAULT_METHOD:"GET",DEFAULT_TIMEOUT:5*1000}}).factory("vdataFactory",["$rootScope","$http","$filter","$httpParamSerializer","vdataConst",function(b,e,d,c,a){return{Get:function(f,g){if(!this.IsValidParam(f)||!angular.isFunction(g)){return false}f.method="GET";return this.Http(f,g)},Post:function(f,g){if(!this.IsValidParam(f)||!angular.isFunction(g)){return a.ERROR.PARAMETER}f.method="POST";return this.Http(f,g)},Put:function(f,g){if(!this.IsValidParam(f)||!angular.isFunction(g)){return a.ERROR.PARAMETER}f.method="PUT";return this.Http(f,g)},Delete:function(f,g){if(!this.IsValidParam(f)||!angular.isFunction(g)){return a.ERROR.PARAMETER}f.method="DELETE";return this.Http(f,g)},Http:function(l,t){var f=this;var s;var p;var h;var g;var q;var o;var n;var r;var j;var k;var i;if(!this.IsValidParam(l,true)||!angular.isFunction(t)){return a.ERROR.PARAMETER}s=a.ERROR.UNKNOWN;p=this.GetSafeMethod(this.GetSafeValue(l,"method",a.CONST.DEFAULT_METHOD));h=this.GetSafeValue(l,"url","");g=this.GetSafeValue(l,"data",{});q=this.GetSafeTimeout(this.GetSafeValue(l,"timeout",a.CONST.DEFAULT_TIMEOUT));o=this.GetSafeVersion(this.GetSafeValue(l,"version",a.CONST.DEFAULT_VERSION));n=Boolean(this.GetSafeValue(l,"async",true));g=(angular.isObject(g)?g:{});k=false;if("POST"==p||"PUT"==p||"DELETE"==p){k=true}r={Accept:(a.CONST.HTTP_HEADER_VERSION_ACCEPT+o)};if(k){r=angular.extend({},r,{"Content-Type":"text/plain"})}j=this.GetDefaultVDataObject();i={method:p,url:h,dataTpe:"json",cache:false,async:n,withCredentials:true,timeout:this.GetSafeTimeout(q),headers:r};i=angular.extend({},i,{params:g});try{e(i).success(function(x,u,w,v){if(f.IsValidVData(x)){j=x}else{j.errorid=a.ERROR.JSON;j.errordesc=("HTTP status: "+u)}t(j)}).error(function(x,u,w,v){j.errorid=a.ERROR.NETWORK;j.errordesc=("HTTP status: "+u);t(j)});s=a.ERROR.SUCCESS}catch(m){s=a.ERROR.EXCEPTION;j.errorid=a.ERROR.EXCEPTION;j.errordesc=m.message;t(j)}return s},IsValidVData:function(f){return(f&&angular.isObject(f)&&f.hasOwnProperty("errorid")&&f.hasOwnProperty("errordesc")&&f.hasOwnProperty("vdata")&&angular.isNumber(f.errorid)&&angular.isString(f.errordesc)&&(angular.isArray(f.vdata)||angular.isObject(f.vdata))&&(f.hasOwnProperty("json")?(angular.isObject(f.json)||angular.isArray(f.json)):true))},GetDefaultVDataObject:function(){return{errorid:a.ERROR.UNKNOWN,errordesc:"",vdata:{},version:a.CONST.DEFAULT_VERSION,json:{}}},IsValidParam:function(h,g){var f;f=false;if(h&&angular.isObject(h)&&h.hasOwnProperty("url")&&angular.isString(h.url)&&h.url.length>0){if(g){if(h.hasOwnProperty("method")&&angular.isString(h.method)){f=true}}else{f=true}}return f},IsSupportedMethod:function(f){if(!angular.isString(f)||0==f.length){return false}f=d("uppercase")(this.TrimString(f));return(a.CONST.HTTP_SUPPORTED_METHODS.hasOwnProperty(f)&&a.CONST.HTTP_SUPPORTED_METHODS[f])},GetSafeMethod:function(f){if(!angular.isString(f)||0==f.length){return a.CONST.DEFAULT_METHOD}var g;f=d("uppercase")(this.TrimString(f));if(this.IsSupportedMethod(f)){g=f}else{g=a.CONST.DEFAULT_METHOD}return g},GetSafeVersion:function(g){if(!angular.isString(g)||0==g.length){return a.CONST.DEFAULT_VERSION}var f;g=this.TrimString(g);if(angular.isString(g)&&g.length>0){f=g}else{f=a.CONST.DEFAULT_VERSION}return f},GetSafeTimeout:function(f){return(angular.isNumber(f)&&f>0)?parseInt(f):a.CONST.DEFAULT_TIMEOUT},GetSafeValue:function(i,g,f){var h;if(!angular.isObject(i)||!angular.isString(g)){return f}h=f;if(i.hasOwnProperty(g)){h=i[g]}return h},TrimString:function(f){if(!angular.isString(f)){return f}return f.replace(/^\s+|\s+$/g,"")}}}]);